let isPlayerOneTurn=!1;const playerOneSymbol="◯",playerTwoSymbol="✖";let playerSymbol=playerOneSymbol,tbodys=document.querySelectorAll("tbody"),activeTables=[],finishedTables=[];function changeTurn(){let e=document.querySelector("#currentTurn");isPlayerOneTurn=!isPlayerOneTurn,playerSymbol=isPlayerOneTurn?playerOneSymbol:playerTwoSymbol,e.innerHTML=(isPlayerOneTurn,`player ${playerSymbol}`)}function checkValidMove(e){if("true"==e.parentElement.parentElement.dataset.active&&""==e.innerHTML)return!0}function checkForWin(e){let t=!1;if(4==Array.from(e.parentElement.children).filter(e=>e.outerText==playerSymbol).length&&(t=!0,console.log("horizontal win")),t){isPlayerOneTurn?document.querySelector("#p1-points").innerHTML=Number(document.querySelector("#p1-points").innerHTML)+1:document.querySelector("#p2-points").innerHTML=Number(document.querySelector("#p2-points").innerHTML)+1,activeTables=[];let e=document.querySelectorAll("tbody[data-active='true']");e.forEach(e=>{0<e.innerText.trim().length&&e.classList.add("played")}),tbodys.forEach(e=>{e.classList.contains("played")?e.setAttribute("data-active","false"):e.setAttribute("data-active","true")})}}function checkBoardPhase(e){if(activeTables.length<2){e=e.parentElement.parentElement;let a=Number(e.dataset.count);if(0==activeTables.length)activeTables.push(a),tbodys.forEach((e,t)=>{console.log(e.classList.contains("played")),0==e.classList.contains("played")&&(e.dataset.count>a-1-(a-1)%4&&e.dataset.count<=a-1+(4-(a-1)%4)||(e.dataset.count-a)%4==0||function checkDiag(e,t){const a=[1,4,6,7,10,11,13,16];var n=Math.floor((t-1)/4),l=(t-1)%4+1,r=(e-1)%4+1,n=Math.floor((e-1)/4)-n;return(r==l+n||r==l-n)&&-1!=a.indexOf(Number(e))&&-1!=a.indexOf(Number(t))}(e.dataset.count,a))?e.setAttribute("data-active","true"):e.setAttribute("data-active","false")});else if(-1==activeTables.indexOf(a))if(activeTables.push(a),Math.floor((activeTables[0]-1)/4)==Math.floor((activeTables[1]-1)/4))tbodys.forEach((e,t)=>{Math.floor((activeTables[0]-1)/4)!=Math.floor((e.dataset.count-1)/4)&&e.setAttribute("data-active","false")});else if(activeTables[0]%4==activeTables[1]%4)tbodys.forEach((e,t)=>{activeTables[0]%4!=e.dataset.count%4&&e.setAttribute("data-active","false")});else{const t=[1,6,11,16];e=[4,7,10,13];let a=-1==t.indexOf(activeTables[0])?e:t;tbodys.forEach((e,t)=>{-1==a.indexOf(Number(e.dataset.count))&&e.setAttribute("data-active","false")})}}}function clickCell(){checkValidMove(this)&&(checkBoardPhase(this),this.innerHTML=`<span>${playerSymbol}</span>`,checkForWin(this),changeTurn())}function init(){let e=document.querySelectorAll("td");e.forEach(e=>{e.addEventListener("click",clickCell)}),tbodys.forEach((e,t)=>{e.setAttribute("data-count",t+1),e.setAttribute("data-active","true")}),changeTurn()}init();